(this["webpackJsonpppsspp-debugger"]=this["webpackJsonpppsspp-debugger"]||[]).push([[0],{188:function(e,t,n){},445:function(e,t,n){},453:function(e,t,n){e.exports=n.p+"static/media/logo.1d4a183a.svg"},458:function(e,t,n){e.exports=n(576)},485:function(e,t,n){},486:function(e,t,n){},487:function(e,t,n){},488:function(e,t,n){},489:function(e,t,n){},490:function(e,t,n){},491:function(e,t,n){},492:function(e,t,n){},552:function(e,t,n){},553:function(e,t,n){},554:function(e,t,n){},555:function(e,t,n){},556:function(e,t,n){},557:function(e,t,n){},558:function(e,t,n){},559:function(e,t,n){},560:function(e,t,n){},561:function(e,t,n){},576:function(e,t,n){"use strict";n.r(t);n(139),n(148),n(149),n(150),n(151),n(152),n(153),n(154),n(155),n(156),n(157),n(158),n(159),n(160),n(161),n(220),n(222),n(223),n(224),n(225),n(226),n(227),n(229),n(230),n(165),n(234),n(235),n(103),n(239),n(240),n(242),n(243),n(244),n(245),n(246),n(247),n(248),n(249),n(250),n(251),n(252),n(253),n(254),n(255),n(257),n(258),n(259),n(260),n(261),n(262),n(173),n(263),n(265),n(267),n(268),n(269),n(270),n(271),n(272),n(273),n(274),n(275),n(276),n(277),n(278),n(279),n(280),n(281),n(175),n(282),n(283),n(284),n(285),n(287),n(288),n(289),n(290),n(291),n(293),n(295),n(297),n(298),n(300),n(301),n(302),n(304),n(305),n(306),n(307),n(308),n(309),n(310),n(312),n(313),n(314),n(315),n(316),n(317),n(318),n(319),n(320),n(176),n(321),n(322),n(323),n(324),n(330),n(331),n(332),n(333),n(334),n(335),n(336),n(337),n(338),n(339),n(340),n(341),n(342),n(343),n(178),n(344),n(345),n(346),n(347),n(348),n(349),n(350),n(126),n(351),n(352),n(354),n(355),n(356),n(357),n(358),n(359),n(360),n(361),n(362),n(363),n(364),n(365),n(366),n(367),n(368),n(369),n(370),n(371),n(372),n(373),n(374),n(375),n(376),n(377),n(380),n(381),n(382),n(383),n(384),n(385),n(386),n(387),n(388),n(389),n(390),n(391),n(392),n(393),n(394),n(395),n(396),n(397),n(398),n(399),n(400),n(401),n(402),n(403),n(404),n(405),n(406),n(407),n(408),n(409),n(410),n(411),n(412),n(413),n(415),n(416),n(418),n(419),n(420),n(421),n(423),n(186);var a=n(0),r=n.n(a),s=n(63),i=n.n(s),o=n(134),l=n.n(o),c=(n(485),n(22)),u=n(5),p=n(6),d=n(9),h=n(7),f=n(10),m=n(137),g=n(74),v=n(456),b=(n(188),function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).handleRequestClose=function(){n.props.confirmClose&&!window.confirm(n.props.confirmClose)||n.props.onClose()},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement(l.a,Object.assign({className:"ReactModal__FitContent",overlayClassName:"ReactModal__FitOverlay",onRequestClose:this.handleRequestClose,closeTimeoutMS:150},this.props))}}]),t}(a.PureComponent)),y=n(457),k=n(82),C=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){if(n.props.onChange)n.props.onChange(e);else if(n.props.component){var t=e.target,a=t.dataset.prop||n.props.prop,r="checkbox"===t.type?t.checked:t.value;n.props.component.setState(Object(k.a)({},a,r))}},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props,t=e.label,n=e.children;return r.a.createElement("div",{className:"Field"},r.a.createElement("label",{className:"Field__label",htmlFor:this.fieldID()},t),this.renderInput(),n)}},{key:"renderInput",value:function(){return"text"===this.props.type?this.renderText():"hex"===this.props.type?this.renderHex():"radio"===this.props.type?this.renderRadio():"checkboxes"===this.props.type?this.renderCheckboxes():null}},{key:"renderText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.props,n=(t.label,t.type,t.children,t.onChange,t.component,t.prop,Object(y.a)(t,["label","type","children","onChange","component","prop"]));return n.value=this.fieldValue(),r.a.createElement("input",Object.assign({type:"text",id:this.fieldID(),onChange:this.handleChange},n,e))}},{key:"renderHex",value:function(){return this.renderText({pattern:"(0x)?[0-9A-Fa-f]+",title:"Hexadecimal value"})}},{key:"renderRadio",value:function(){var e=this,t=this.fieldValue();return this.props.options.map((function(n){var a={name:e.fieldID(),value:n.value,checked:t===n.value,onChange:e.handleChange,disabled:e.props.disabled};return r.a.createElement("label",{key:n.value},r.a.createElement("input",Object.assign({type:"radio"},a))," "+n.label)}))}},{key:"renderCheckboxes",value:function(){var e=this;return this.props.options.map((function(t){var n={"data-prop":t.value,checked:e.props.component.state[t.value],onChange:e.handleChange,disabled:e.props.disabled};return r.a.createElement("label",{key:t.value},r.a.createElement("input",Object.assign({type:"checkbox"},n))," "+t.label)}))}},{key:"fieldID",value:function(){var e=this.props,t=e.id,n=e.component,a=e.prop;return!t&&n&&a?(n.displayName||n.constructor.name)+"__"+a:t}},{key:"fieldValue",value:function(){var e=this.props,t=e.value,n=e.component,a=e.prop;return void 0===t&&n&&a?n.state[a]:t}}]),t}(a.Component),S=n(2),E=n.n(S),_=n(13),w=n.n(_);n(486);function O(e){return r.a.createElement("form",{action:"#",className:w()(e.className,"Form"),onSubmit:e.onSubmit},e.heading?r.a.createElement("h2",{className:"Form__heading"},e.heading):null,e.children)}O.Buttons=function(e){var t=!0!==e.onSave?e.onSave:void 0,n=e.onSave?r.a.createElement("button",{onClick:t},"Save"):null,a=e.onCancel?r.a.createElement("button",{type:"button",onClick:e.onCancel},"Cancel"):null;return r.a.createElement("div",{className:"Form__buttons"},e.children,n,a)},O.Buttons.propTypes={onSave:E.a.oneOfType([E.a.func,E.a.bool]),onCancel:E.a.func,children:E.a.node};var D=O,T=function(){function e(t,n){Object(u.a)(this,e),this.func=t,this.ms=n}return Object(p.a)(e,[{key:"start",value:function(){var e=this;this.cancel(),this.handle=setTimeout((function(){e.handle=null,e.func()}),this.ms)}},{key:"reset",value:function(e){this.func=e}},{key:"runEarly",value:function(){this.handle&&(this.cancel(),this.func())}},{key:"cancel",value:function(){null!==this.handle&&(clearTimeout(this.handle),this.handle=null)}}]),e}();function j(e){return("00000000"+e.toString(16).toUpperCase()).substr(-8)}n(487);var P=[{label:"Memory",value:"memory"},{label:"Execute",value:"execute"}],x=[{label:"Read",value:"read"},{label:"Write",value:"write"},{label:"On change",value:"change"}],L=[{label:"Break",value:"enabled"},{label:"Log",value:"log"}],N=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={},n.cleanState={isOpen:!1,derivedBreakpoint:null},n.cleanBreakpoint={type:"memory",address:"",size:"0x00000001",condition:"",logFormat:"",read:!0,write:!0,change:!1,enabled:!0,log:!0},n.onSave=function(e){var t=n.props.ppsspp.send({event:"cpu.evaluate",thread:n.props.currentThread,expression:n.state.address});if(null!==n.props.breakpoint){var a=n.state,r=a.derivedBreakpoint,s=a.address,i=a.size,o=a.type;t=o!==r.type||r.address!==s||"memory"===o&&r.size!==i?t.then(n.deleteOld).then(n.saveNew):t.then(n.updateExisting)}else t=t.then(n.saveNew);t.then(n.onClose,(function(e){window.alert(e.message)})),e.preventDefault()},n.saveNew=function(e){var t=e.uintValue;return n.props.ppsspp.send(Object(c.a)({event:n.getEvent(n.state.type,"add")},n.state,{address:t}))},n.deleteOld=function(e){var t=e.uintValue;return n.props.ppsspp.send({event:n.getEvent(n.props.breakpoint.type,"remove"),address:n.props.breakpoint.address}).then((function(){return{uintValue:t}}))},n.updateExisting=function(e){var t=e.uintValue;return n.props.ppsspp.send(Object(c.a)({event:n.getEvent(n.state.type,"update")},n.state,{address:t}))},n.onClose=function(){n.cleanTimeout.start(),n.props.onClose()},Object.assign(n.state,Object(c.a)({},n.cleanState,{},n.cleanBreakpoint,{},e.breakpoint)),n.cleanTimeout=new T((function(){n.setState(Object(c.a)({},n.cleanState,{},n.cleanBreakpoint,{},n.props.breakpoint))}),200),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=null!==this.props.breakpoint;return r.a.createElement(b,{contentLabel:"Breakpoint settings",isOpen:this.props.isOpen,onClose:this.onClose,confirmClose:this.hasChanges()?"Discard changes?":null},r.a.createElement(D,{heading:e?"Edit Breakpoint":"Create Breakpoint",onSubmit:this.onSave,className:"BreakpointModal"},r.a.createElement(C,{type:"radio",label:"Type",options:P,prop:"type",component:this}),r.a.createElement(C,{type:"text",label:"Address",prop:"address",component:this}),this.renderMemory(),this.renderExecute(),r.a.createElement(C,{type:"text",label:"Log format",prop:"logFormat",component:this,disabled:!this.state.log}),r.a.createElement(C,{type:"checkboxes",label:"Actions",options:L,component:this}),r.a.createElement(D.Buttons,{onSave:!0,onCancel:this.onClose})))}},{key:"renderMemory",value:function(){return"memory"!==this.state.type?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(C,{type:"hex",label:"Size",prop:"size",component:this}),r.a.createElement(C,{type:"checkboxes",label:"Operations",options:x,component:this}))}},{key:"renderExecute",value:function(){return"execute"!==this.state.type?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(C,{type:"text",label:"Condition",prop:"condition",component:this}))}},{key:"hasChanges",value:function(){var e=this,t=this.state.derivedBreakpoint||this.cleanBreakpoint;return void 0!==Object.keys(t).find((function(n){return e.state[n]!==t[n]}))}},{key:"componentDidUpdate",value:function(e,t){this.props.isOpen&&null!=this.cleanTimeout&&this.cleanTimeout.runEarly()}},{key:"getEvent",value:function(e,t){if("execute"===e)return"cpu.breakpoint."+t;if("memory"===e)return"memory.breakpoint."+t;throw new Error("Unexpected type: "+e)}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.isOpen&&!t.isOpen){var n=e.breakpoint;return n&&(n.address="0x"+j(n.address),n.condition=n.condition||"",n.logFormat=n.logFormat||""),Object(c.a)({isOpen:!0},n,{derivedBreakpoint:n})}return!e.isOpen&&t.derivedBreakpoint?{derivedBreakpoint:null}:null}}]),t}(a.PureComponent),B=n(17),R=!0,M=[];function V(){var e=document.getElementById("clipboard-scratchpad");return e||function(){var e=document.createElement("div");return e.id="clipboard-scratchpad",e.style.width=1,e.style.height=1,e.style.opacity=0,e.style.position="absolute",e.style.top=0,e.style.left=0,e.style.pointerEvents="none",e.style.whiteSpace="pre",document.body.appendChild(e),e}()}function A(e){R=!1;try{var t=V();t.textContent=e;var n=t.firstChild,a=document.createRange();a.setStart(n,0),a.setEnd(n,e.length);var r=window.getSelection(),s=0!==r.rangeCount?r.getRangeAt(0):null;r.removeAllRanges(),r.addRange(a);try{document.execCommand("copy")}catch(i){window.prompt("Use Ctrl-C or Command-C to copy",e)}r.removeAllRanges(),s&&r.addRange(s)}finally{R=!0}}function F(e,t){for(;e&&e!==document;){if(e.matches(t))return!0;e=e.parentNode}return!1}Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector),document.addEventListener("copy",(function(e){var t=0!==document.getSelection().rangeCount?document.getSelection().getRangeAt(0):null;if((!t||t.collapsed)&&R){var n=!0,a=!1,r=void 0;try{for(var s,i=M[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var o=s.value;if(F(document.activeElement,o.selector)){var l=o.handler(e);l&&(/win/i.test(window.navigator.platform)?e.clipboardData.setData("text/plain",l.replace(/\n/g,"\r\n")):e.clipboardData.setData("text/plain",l),e.preventDefault())}}}catch(c){a=!0,r=c}finally{try{n||null==i.return||i.return()}finally{if(a)throw r}}}}));var I=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).handleCopyAddress=function(e,t){A(j(t.line.address)),t.node.focus()},n.handleCopyHex=function(e,t){A(n.props.getSelectedLines().map((function(e){return e.macroEncoding?e.macroEncoding.map(j).join("\n"):j(e.encoding)})).join("\n")),t.node.focus()},n.handleCopyDisasm=function(e,t){A(n.props.getSelectedDisasm()),t.node.focus()},n.handleAssemble=function(e,t){setTimeout((function(){n.props.assembleInstruction(t.line,"").catch((function(){}))}),0)},n.handleRunUntil=function(e,t){n.props.ppsspp.send({event:"cpu.runUntil",address:t.line.address}).catch((function(){})),t.node.focus()},n.handleJumpPC=function(e,t){n.props.ppsspp.send({event:"cpu.setReg",thread:n.props.currentThread,name:"pc",value:t.line.address}).catch((function(e){n.props.log("Failed to update PC: "+e)}))},n.handleToggleBreakpoint=function(e,t){n.props.toggleBreakpoint(t.line)},n.handleFollowBranch=function(e,t){n.props.followBranch(!0,t.line)},n.handleTodo=function(e,t){console.log(t),t.node.focus()},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props,t=e.id,n=e.trigger,a=!this.props.stepping,s=n&&n.line,i=s&&(null!==s.branch||null!==s.relevantData||"data"===s.type);return r.a.createElement(B.a,{id:t},r.a.createElement(B.c,{onClick:this.handleCopyAddress},"Copy Address"),r.a.createElement(B.c,{onClick:this.handleCopyHex},"Copy Instruction (Hex)"),r.a.createElement(B.c,{onClick:this.handleCopyDisasm},"Copy Instruction (Disasm)"),r.a.createElement(B.c,{divider:!0}),r.a.createElement(B.c,{disabled:a,onClick:this.handleAssemble},"Assemble Opcode..."),r.a.createElement(B.c,{divider:!0}),r.a.createElement(B.c,{disabled:a,onClick:this.handleRunUntil},"Run to Cursor"),r.a.createElement(B.c,{disabled:a,onClick:this.handleJumpPC},"Jump to Cursor"),r.a.createElement(B.c,{onClick:this.handleToggleBreakpoint},"Toggle Breakpoint"),r.a.createElement(B.c,{divider:!0}),r.a.createElement(B.c,{disabled:!i,onClick:this.handleFollowBranch},"Follow Branch"),r.a.createElement(B.c,{data:{action:"goto_memory"},onClick:this.handleTodo},"Go to in Memory View"),r.a.createElement(B.c,{data:{action:"goto_jit"},onClick:this.handleTodo},"Go to in Jit Compare"),r.a.createElement(B.c,{divider:!0}),r.a.createElement(B.c,{data:{action:"func_rename"},onClick:this.handleTodo},"Rename Function..."),r.a.createElement(B.c,{data:{action:"func_remove"},onClick:this.handleTodo},"Remove Function"),r.a.createElement(B.c,{data:{action:"func_add"},onClick:this.handleTodo},"Add Function Here"))}}]),t}(a.PureComponent),U=Object(B.d)("disasm")(I),H=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.calcPos();if(null===e||0===this.props.lineHeight)return null;var t=w()({DisasmBranchGuide:!0,"DisasmBranchGuide--selected":this.props.selected});return r.a.createElement("div",{className:t,style:e},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:e.height},r.a.createElement("path",{d:this.buildPath(e.height)})))}},{key:"buildPath",value:function(e){var t=this.props,n=t.guide,a=t.range,r=t.lineHeight,s=Math.floor(r/2)+.5,i="m7.5,-".concat(s," l0,").concat(r," m-7.5,-").concat(r-s),o="m5.5,-4 l-4,4 l4,4 m-3.5,-4 l6,0 m-8,0",l=["M0,"+s];return n.top<a.start?l.push(i):"up"===n.direction?l.push(o):l.push("m3,0 l5,0 m-8,0"),l.push("m7.5,0 l0,"+(e-r)+" m-7.5,0"),n.bottom>=a.end?l.push(i):"down"===n.direction?l.push(o):l.push("m3,0 l5,0 m-8,0"),l}},{key:"calcPos",value:function(){var e=this.props.guide,t=this.findAddressOffset(e.top,!1),n=this.findAddressOffset(e.bottom,!0);return null===t||null===n?null:{top:t,right:8*(16-e.lane),height:n-t}}},{key:"findAddressOffset",value:function(e,t){var n,a=this.props,r=a.offsets,s=a.range;if(e>=s.end)return s.end-4 in r&&t?r[s.end-4]+this.props.lineHeight:s.end-8 in r&&t?r[s.end-8]+this.props.lineHeight:null;if(e<s.start&&!t)n=0;else if(e in r)n=r[e];else{if(!(e-4 in r))return null;n=r[e-4]}return t?n+this.props.lineHeight:n}}]),t}(a.PureComponent);function G(e,t){return!(e.top<t.top||e.left<t.left)&&!(e.bottom>t.bottom||e.right>t.right)}function q(e,t){return!function(e){var t={top:0,left:0,bottom:window.innerHeight,right:window.innerWidth},n=e.getBoundingClientRect();if(!G(n,t))return!1;for(var a=e;null!==(a=a.parentNode);)if(a instanceof HTMLElement){var r=window.getComputedStyle(a),s=r.overflow+r.overflowX+r.overflowY;if("static"===r.position&&-1===s.indexOf("auto")&&-1===s.indexOf("scroll"))continue;if(!G(n,a.getBoundingClientRect()))return!1}return!0}(e)&&(e.scrollIntoView(t),!0)}var z=!1;function W(){return z}function K(e){return r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:e.className,viewBox:"0 0 1536 1536",width:"12",height:"12"},r.a.createElement("path",{d:"M768,0 q209,0 385.5,103 t279.5,279.5 t103,385.5 t-103,385.5 t-279.5,279.5 t-385.5,103 t-385.5,-103 t-279.5,-279.5 t-103,-385.5 t103,-385.5 t279.5,-279.5 t385.5,-103 zm128,1247 v-190 q0,-14 -9,-23.5 t-22,-9.5 h-192 q-13,0 -23,10 t-10,23 v190 q0,13 10,23 t23,10 h192 q13,0 22,-9.5 t9,-23.5 zm-2,-344 l18,-621 q0,-12 -10,-18 q-10,-8 -24,-8 h-220 q-14,0 -24,8 q-10,6 -10,18 l17,621 q0,10 10,17.5 t24,7.5 h185 q14,0 23.5,-7.5 t10.5,-17.5 z"}))}window.addEventListener("REACT_CONTEXTMENU_SHOW",(function(e){z=!0})),window.addEventListener("REACT_CONTEXTMENU_HIDE",(function(e){z=!1}));var J=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).ref=r.a.createRef(),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.line,a=t.selected,s=t.focused,i=t.cursor,o=w()({DisasmLine:!0,"DisasmLine--selected":a&&!s,"DisasmLine--focused":s,"DisasmLine--cursor":i,"DisasmLine--breakpoint":n.breakpoint&&n.breakpoint.enabled,"DisasmLine--disabled-breakpoint":n.breakpoint&&!n.breakpoint.enabled,"DisasmLine--current":n.isCurrentPC}),l=function(t){return{line:n,node:e.ref.current.parentNode}},c={onDoubleClick:function(t){return e.onDoubleClick(t,l())},tabIndex:0};return r.a.createElement(B.b,{id:this.props.contextmenu,renderTag:"a",collect:l,attributes:c},r.a.createElement("div",{className:o,style:{backgroundColor:n.backgroundColor},ref:this.ref,"data-address":n.address},r.a.createElement(K,{className:"DisasmLine__breakpoint-icon"}),this.renderAddress(n),r.a.createElement("code",{className:"DisasmLine__opcode"},this.highlight(n.name,"",n.params)," "),r.a.createElement("code",{className:"DisasmLine__params"},this.highlightParams(n.params,n.name,""),this.renderConditional(n))))}},{key:"renderAddress",value:function(e){var t=e.symbol,n=e.address,a=e.encoding,s=j(n);return this.props.displaySymbols?null!==t?r.a.createElement("code",{className:"DisasmLine__address DisasmLine__address--symbol"},this.highlight(t+":")):r.a.createElement("code",{className:"DisasmLine__address DisasmLine__address--nosymbol"},this.highlight(s)):r.a.createElement("code",{className:"DisasmLine__address DisasmLine__address--hexonly"},this.highlight(s)," ",j(a))}},{key:"renderConditional",value:function(e){return e.isCurrentPC&&null!==e.conditionMet?e.conditionMet?" ; true":" ; false":""}},{key:"highlight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=this.props.highlight;if(null!==a){var s=(t?t+" ":"")+e+" "+n,i=s.toLowerCase().indexOf(a),o=a.length;if(-1!==i){var l=t?t.length+1:0;i<l?i=(o-=l-i)>0?0:-1:i-=l}if(i>=0&&i<e.length){var c=w()({DisasmLine__highlight:!0,"DisasmLine__highlight--end":i+o>e.length+1});return r.a.createElement(r.a.Fragment,null,e.substr(0,i),r.a.createElement("span",{className:c},e.substr(i,o)),e.substr(i+o))}}return e}},{key:"highlightParams",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=this.props,s=a.highlight,i=a.highlightParams;if(null===s){var o=e.split(/([,()])/),l=i||[];return o.map((function(e,t){var n="DisasmLine__param";return l.includes(e)&&(n+=" DisasmLine__param--highlighted"),r.a.createElement("span",{className:n,key:t},e)}))}return this.highlight(e,t,n)}},{key:"onDoubleClick",value:function(e,t){0===e.button&&this.props.onDoubleClick(e,t)}},{key:"ensureInView",value:function(e){var t=this.ref.current.parentNode;!1!==e&&q(t,{block:e}),t.focus()}}],[{key:"addressBoundingTop",value:function(e,t){var n=e.querySelector('.DisasmLine[data-address="'+t+'"]');return n?n.parentNode.getBoundingClientRect().top:null}}]),t}(a.PureComponent),X=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={mouseDown:!1,focused:!1,lineOffsets:{},pendingLineParams:[],selectedLineParams:[],prevLines:null,prevSelectionTop:null,prevSelectionBottom:null},n.onCopy=function(e){return n.props.getSelectedDisasm()},n.ref=r.a.createRef(),n.cursorRef=r.a.createRef(),n.focusTimeout=new T((function(){return null}),20),n.paramsTimeout=new T((function(){n.setState({selectedLineParams:n.state.pendingLineParams})}),20),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t={onMouseDownCapture:function(t){return e.onMouseDown(t)},onMouseUpCapture:this.state.mouseDown?function(t){return e.onMouseUp(t)}:void 0,onMouseMove:this.state.mouseDown?function(t){return e.onMouseMove(t)}:void 0,onKeyDown:function(t){return e.onKeyDown(t)},onBlur:function(t){return e.onFocusChange(t,!1)},onFocus:function(t){return e.onFocusChange(t,!0)}};return r.a.createElement("div",Object.assign({className:"Disasm__list",ref:this.ref},t),this.props.lines.map((function(t){return e.renderLine(t)})),this.props.branchGuides.map((function(t){return e.renderBranchGuide(t)})))}},{key:"renderLine",value:function(e){var t=this.props,n=t.displaySymbols,a=t.cursor,s={displaySymbols:n,line:e,selected:this.isLineSelected(e),cursor:e.address===a,onDoubleClick:this.props.onDoubleClick,ref:e.address===a?this.cursorRef:void 0,highlight:this.shouldHighlight(e,this.props.highlightText)?this.props.highlightText:null,highlightParams:this.shouldHighlightParams(e)?this.state.selectedLineParams:null};return s.focused=s.selected&&this.state.focused,r.a.createElement(J,Object.assign({key:e.address,contextmenu:"disasm"},s))}},{key:"renderBranchGuide",value:function(e){var t=String(e.top)+String(e.bottom)+e.direction,n=this.props,a=n.range,s=n.lineHeight,i=n.cursor,o={key:t,guide:e,offsets:this.state.lineOffsets,range:a,lineHeight:s,selected:e.top===i||e.bottom===i};return r.a.createElement(H,o)}},{key:"shouldHighlight",value:function(e,t){var n=[];return n.push(j(e.address)),null!==e.symbol&&n.push(e.symbol+":"),n.push(e.name+" "+e.params),n.some((function(e){return-1!==e.toLowerCase().indexOf(t)}))}},{key:"shouldHighlightParams",value:function(e,t){return!this.isLineSelected(e)&&this.state.selectedLineParams.some((function(t){return-1!==e.params.indexOf(t)}))}},{key:"addressBoundingTop",value:function(e){return J.addressBoundingTop(this.ref.current,e)}},{key:"ensureCursorInView",value:function(e){this.cursorRef.current&&this.cursorRef.current.ensureInView(e)}},{key:"isLineSelected",value:function(e){return t.isLineSelected(this.props,e)}},{key:"componentDidMount",value:function(){var e,t;e=".Disasm__list",t=this.onCopy,M.push({selector:e,handler:t})}},{key:"componentWillUnmount",value:function(){var e,t;e=".Disasm__list",t=this.onCopy,M=M.filter((function(n){return n.selector!==e&&n.handler!==t})),this.paramsTimeout.cancel()}},{key:"componentDidUpdate",value:function(e,t){this.state.pendingLineParams!==t.pendingLineParams&&this.paramsTimeout.start()}},{key:"onFocusChange",value:function(e,t){var n=this,a=function(){t!==n.state.focused&&n.setState({focused:t})};this.focusTimeout.cancel(),t?a():(this.focusTimeout.reset(a),this.focusTimeout.start())}},{key:"onMouseDown",value:function(e){var t=this.mouseEventToLine(e);2===e.button&&this.isLineSelected(t)?this.props.updateCursor(t.address):this.applySelection(e,t),0===e.button&&this.setState({mouseDown:!0})}},{key:"onMouseUp",value:function(e){var t=this.mouseEventToLine(e);t&&this.applySelection(e,t),this.setState({mouseDown:!1})}},{key:"onMouseMove",value:function(e){if(0!==e.buttons){var t=this.mouseEventToLine(e);t&&this.applySelection(e,t)}else this.setState({mouseDown:!1})}},{key:"onKeyDown",value:function(e){if(!W()){var t=(e.ctrlKey?"c":"")+(e.metaKey?"m":"")+(e.altKey?"a":"")+(e.shiftKey?"s":"");if(["ArrowUp","ArrowDown","PageUp","PageDown"].includes(e.key)){var n=1;if("PageUp"!==e.key&&"PageDown"!==e.key||(n=this.props.visibleLines),"ArrowUp"!==e.key&&"PageUp"!==e.key||(n=-n),""===t||"s"===t){var a=this.findCursorLineIndex(),r=Math.min(this.props.lines.length-1,Math.max(0,a+n));a!==r&&(this.applySelection(e,this.props.lines[r]),e.preventDefault())}else e.ctrlKey&&(this.props.applyScroll(n),e.preventDefault())}"ArrowLeft"!==e.key&&"ArrowRight"!==e.key||""!==t||(this.props.followBranch("ArrowRight"===e.key,this.findCursorLine()),e.preventDefault()),"Tab"===e.key&&""===t&&(this.props.updateDisplaySymbols(!this.props.displaySymbols),e.preventDefault()),"a"===e.key&&"c"===t&&(this.props.assembleInstruction(this.findCursorLine(),""),e.preventDefault())," "!==e.key&&"Spacebar"!==e.key||""!==t||(this.props.toggleBreakpoint(this.findCursorLine()),e.preventDefault()),"d"===e.key&&"c"===t&&(this.props.toggleBreakpoint(this.findCursorLine(),!0),e.preventDefault()),"s"!==e.key&&"f"!==e.key||"c"!==t||(this.props.searchPrompt(),e.preventDefault()),"F3"===e.key&&""===t&&(this.props.searchNext(),e.preventDefault()),"g"===e.key&&"c"===t&&(this.props.promptGoto(),e.preventDefault()),"e"===e.key&&"c"===t&&(this.props.editBreakpoint(this.findCursorLine()),e.preventDefault())}}},{key:"applySelection",value:function(e,t){var n=this.props,a=n.selectionTop,r=n.selectionBottom;e.shiftKey?(a=Math.min(a,t.address),r=Math.max(r,t.address)):(a=t.address,r=t.address),a===this.props.selectionTop&&r===this.props.selectionBottom||this.props.updateSelection({selectionTop:a,selectionBottom:r}),this.props.updateCursor(t.address)}},{key:"mouseEventToLine",value:function(e){var t=e.pageY-this.ref.current.getBoundingClientRect().top-window.pageYOffset,n=Math.floor(t/this.props.lineHeight);return this.props.lines[n]}},{key:"findCursorLineIndex",value:function(){for(var e=this.props,t=e.cursor,n=e.lines,a=e.selectionTop,r=t||a,s=0;s<n.length;++s)if(n[s].address===r)return s}},{key:"findCursorLine",value:function(){var e=this.findCursorLineIndex();return this.props.lines[e]}}],[{key:"isLineSelected",value:function(e,t){var n=e.selectionTop,a=e.selectionBottom;return t.address+t.addressSize>n&&t.address<=a}},{key:"calcOffsets",value:function(e,t){var n=0,a={};return e.forEach((function(e){a[e.address]=n,n+=t})),a}},{key:"getSelectedLineParams",value:function(e){var n=e.lines,a=e.selectionTop,r=e.selectionBottom,s=n.filter(t.isLineSelected.bind(null,{selectionTop:a,selectionBottom:r})),i={},o=!0,l=!1,c=void 0;try{for(var u,p=s[Symbol.iterator]();!(o=(u=p.next()).done);o=!0){var d=u.value,h=!0,f=!1,m=void 0;try{for(var g,v=d.params.split(/[,()]/)[Symbol.iterator]();!(h=(g=v.next()).done);h=!0){var b=g.value;i[b]=b}}catch(y){f=!0,m=y}finally{try{h||null==v.return||v.return()}finally{if(f)throw m}}}}catch(y){l=!0,c=y}finally{try{o||null==p.return||p.return()}finally{if(l)throw c}}return delete i[""],Object.values(i)}},{key:"getDerivedStateFromProps",value:function(e,n){var a=e.lines!==n.prevLines,r=e.selectionTop!==n.prevSelectionTop||e.selectionBottom!==n.prevSelectionBottom,s=null;a&&(s={lineOffsets:t.calcOffsets(e.lines,e.lineHeight),prevLines:e.lines});var i=null;return(a||r)&&(i={pendingLineParams:t.getSelectedLineParams(e),prevSelectionTop:e.selectionTop,prevSelectionBottom:e.selectionBottom}),null!==s||null!==i?Object(c.a)({},s,{},i):null}}]),t}(a.PureComponent),Y=(n(488),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).handleChange=function(e){n.props.updateSearchString(e.target.value)},n.handleNext=function(e){n.props.searchNext(),n.focus(),e.preventDefault()},n.handleCancel=function(e){n.props.updateSearchString(null)},n.handleKeyDown=function(e){"Escape"===e.key&&(n.handleCancel(),e.preventDefault())},n.ref=r.a.createRef(),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props.searchString||"",t=w()("DisasmSearch__field",{"DisasmSearch__field--progress":this.props.inProgress});return r.a.createElement("form",{action:"#",className:"DisasmSearch",hidden:null===this.props.searchString,onSubmit:this.handleNext},r.a.createElement("div",{className:t},r.a.createElement("input",{type:"search",value:e,placeholder:"Find...",onChange:this.handleChange,onKeyDown:this.handleKeyDown,ref:this.ref})),r.a.createElement("button",{type:"submit"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",width:"15",height:"15",role:"img"},r.a.createElement("title",null,"Search / Next"),r.a.createElement("path",{d:"M10,50 l80,0 l-35,-40 m35,40 l-35,40"}))),r.a.createElement("button",{type:"button",onClick:this.handleCancel},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 180 180",width:"15",height:"15",role:"img"},r.a.createElement("title",null,"Cancel"),r.a.createElement("path",{d:"M30,30 l120,120 m-120,0 l120,-120"}))))}},{key:"componentDidUpdate",value:function(e,t){null===e.searchString&&null!==this.props.searchString&&this.focus()}},{key:"focus",value:function(){this.ref.current.focus()}}]),t}(a.PureComponent)),$=(n(489),function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props.line;return e?r.a.createElement("div",{className:"StatusBar"},r.a.createElement("div",{className:"StatusBar__left"},this.renderLeftStatus(e)),r.a.createElement("div",{className:"StatusBar__right"},e.function||e.symbol||"")):r.a.createElement("div",{className:"StatusBar"})}},{key:"renderLeftStatus",value:function(e){if("opcode"===e.type||"macro"===e.type){if(e.dataAccess)return this.renderDataAccess(e.dataAccess);if(e.branch)return this.renderBranch(e.branch)}else if("data"===e.type)return this.renderDataSymbol(e.dataSymbol,e.address);return""}},{key:"renderDataAccess",value:function(e){if(null===e.uintValue)return"Invalid address "+j(e.address);var t="["+j(e.address)+"] = ";return e.valueSymbol&&(t+=e.valueSymbol+" ("),1===e.size?t+=("00"+e.uintValue.toString(16).toUpperCase()).substr(-2):2===e.size?t+=function(e){return("0000"+e.toString(16).toUpperCase()).substr(-4)}(e.uintValue):e.size>=4&&(t+=j(e.uintValue)),e.valueSymbol&&(t+=")"),t}},{key:"renderBranch",value:function(e){var t=e.targetAddress?j(e.targetAddress):"";return e.symbol&&(t+=" = "+e.symbol),t}},{key:"renderDataSymbol",value:function(e,t){var n=j(e.start);return e.label&&(n+=" ("+e.label+")"),t!==e.start&&(n+=" + "+j(e.start-t)),n}}]),t}(a.PureComponent)),Q=new(function(){function e(){Object(u.a)(this,e),this.changeCallbacks_=[],this.ppsspp_=null,this.connected_=!1}return Object(p.a)(e,[{key:"init",value:function(e){this.ppsspp_=e}},{key:"change",value:function(e){this.connected_=e;var t=!0,n=!1,a=void 0;try{for(var r,s=this.changeCallbacks_[Symbol.iterator]();!(t=(r=s.next()).done);t=!0){(0,r.value)(e)}}catch(i){n=!0,a=i}finally{try{t||null==s.return||s.return()}finally{if(n)throw a}}}},{key:"onConnectionChange",value:function(e){var t=this;return this.changeCallbacks_.push(e),{remove:function(){var n=t.changeCallbacks_.indexOf(e);-1!==n&&t.changeCallbacks_.splice(n,1)}}}},{key:"onConnection",value:function(e){return this.connected_&&e(!0),this.onConnectionChange((function(t){t&&e(!0)}))}},{key:"listen",value:function(e){var t=[];for(var n in e)if(e.hasOwnProperty(n)){var a=void 0;a="connection"===n?this.onConnection(e[n]):"connection.change"===n?this.onConnectionChange(e[n]):this.ppsspp_.listen(n,e[n]),t.push(a)}return t}},{key:"forget",value:function(e){var t=!0,n=!1,a=void 0;try{for(var r,s=e[Symbol.iterator]();!(t=(r=s.next()).done);t=!0){r.value.remove()}}catch(i){n=!0,a=i}finally{try{t||null==s.return||s.return()}finally{if(n)throw a}}}}]),e}()),Z=(n(490),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={lines:[],branchGuides:[],range:{start:0,end:0},lineHeight:0,visibleLines:0,displaySymbols:!0,wantDisplaySymbols:!0,cursor:null,searchString:null,searchInProgress:!1,highlightText:null,editingBreakpoint:null},n.jumpStack=[],n.needsScroll=!1,n.needsOffsetFix=!1,n.updatesCancel=!1,n.updatesSequence=Promise.resolve(null),n.lastSearch=null,n.updateCursor=function(e){n.state.cursor!==e&&(n.needsScroll="nearest",n.setState({cursor:e}),n.updatesSequence=n.updatesSequence.then((function(){if(n.updatesCancel)return null;var t=n.state.range,a=t.start,r=t.end,s=Math.max(100,n.state.visibleLines),i=Math.max(500,5*n.state.visibleLines);return e-4*s<a?a=e-2*s*4:e-4*i>a&&(a=e-4*(i-s)),e+4*s>r?r=e+2*s*4:e+4*i<r&&(r=e+4*(i-s)),a!==n.state.range.start||r!==n.state.range.end?n.updateDisasmNow("nearest",{address:a,end:r}):null})))},n.getSelectedLines=function(){var e=n.props,t=e.selectionTop,a=e.selectionBottom;return n.state.lines.filter((function(e){return e.address+e.addressSize>t&&e.address<=a}))},n.getSelectedDisasm=function(){var e=n.getSelectedLines(),t={},a=e.map((function(e){return e.branch})).filter((function(e){return e&&!e.symbol&&e.targetAddress})),r=!0,s=!1,i=void 0;try{for(var o,l=a[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var c=o.value;t[c.targetAddress]="pos_"+j(c.targetAddress)}}catch(y){s=!0,i=y}finally{try{r||null==l.return||l.return()}finally{if(s)throw i}}var u="",p=!0,d=!0,h=!1,f=void 0;try{for(var m,g=e[Symbol.iterator]();!(d=(m=g.next()).done);d=!0){var v=m.value,b=v.symbol||t[v.address];b&&(p||(u+="\n"),u+=b+":\n\n"),u+="\t"+v.name+" ",v.branch&&v.branch.targetAddress&&!v.branch.symbol?u+=v.params.replace(/0x[0-9A-f]+/,t[v.branch.targetAddress]):u+=v.params,u+="\n",p=!1}}catch(y){h=!0,f=y}finally{try{d||null==g.return||g.return()}finally{if(h)throw f}}return u},n.updateDisplaySymbols=function(e){n.setState({wantDisplaySymbols:e})},n.followBranch=function(e,t){if(e){var a=t.branch&&t.branch.targetAddress;null===a&&(a=t.relevantData&&t.relevantData.address),null!==a&&(n.jumpStack.push(n.state.cursor),n.gotoAddress(a))}else 0!==n.jumpStack.length?n.gotoAddress(n.jumpStack.pop()):n.gotoAddress(n.props.pc)},n.assembleInstruction=function(e,t){var a=e.address,r=prompt("Assemble instruction",t);if(!r)return Promise.resolve(null);var s=function(){return n.props.ppsspp.send({event:"memory.assemble",address:a,code:r}).then((function(){if(a===n.state.cursor){var t=n.state.lines.indexOf(e);if(t<n.state.lines.length-1){var r=n.state.lines[t+1].address;n.gotoAddress(r,"nearest")}}n.updateDisasm()}))},i=r.split(/\s*=\s*(.+)$/,2);return i.length>=2?n.props.ppsspp.send({event:"cpu.evaluate",thread:n.props.currentThread,expression:i[1]}).then((function(e){return n.props.ppsspp.send({event:"cpu.setReg",thread:n.props.currentThread,name:i[0],value:e.uintValue})})).then((function(e){var t=e.uintValue;n.props.log("Updated "+i[0]+" to "+j(t))}),s):s()},n.toggleBreakpoint=function(e,t){if(null===e.breakpoint)n.props.ppsspp.send({event:"cpu.breakpoint.add",address:e.address,enabled:!0});else if(e.breakpoint.enabled)if(t)n.props.ppsspp.send({event:"cpu.breakpoint.update",address:e.address,enabled:!1});else{if(null!==e.breakpoint.condition&&!window.confirm("This breakpoint has has a condition.\n\nAre you sure you want to remove it?"))return;n.props.ppsspp.send({event:"cpu.breakpoint.remove",address:e.address})}else n.props.ppsspp.send({event:"cpu.breakpoint.update",address:e.address,enabled:!0})},n.editBreakpoint=function(e){n.props.ppsspp.send({event:"cpu.breakpoint.list",address:e.address,enabled:!0}).then((function(t){var a=t.breakpoints.find((function(t){return t.address===e.address}));if(a){var r=Object(c.a)({},a,{type:"execute"});n.setState({editingBreakpoint:r})}}))},n.closeEditBreakpoint=function(){n.setState({editingBreakpoint:null})},n.gotoAddress=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"center";n.needsScroll=t,n.props.updateSelection({selectionTop:e,selectionBottom:e})},n.searchDisasm=function(e){var t=e&&null!==n.lastSearch,a=n.state,r=a.cursor,s=a.searchString;if(t||s){if(n.state.searchInProgress){if(t)return;n.searchCancel()}t||(n.lastSearch={match:s,end:r,last:null});var i={cancel:!1};n.lastSearch.cancelState=i,n.setState({searchInProgress:!0});var o=n.lastSearch,l=o.match,c=o.end,u=o.last;n.props.ppsspp.send({event:"memory.searchDisasm",address:r===u?r+4:r,end:c,match:l}).then((function(e){var t=e.address;i.cancel||(n.lastSearch&&(n.lastSearch.last=t),null!==t?n.gotoAddress(t):r!==c?(window.alert("Reached the starting point of the search"),n.gotoAddress(c)):window.alert("The specified text was not found:\n\n"+l))})).finally((function(){i.cancel||(n.setState({searchInProgress:!1}),n.lastSearch&&(n.lastSearch.cancelState=null))}))}else n.searchPrompt()},n.updateSearchString=function(e){var t=e?e.toLowerCase():null;n.setState({highlightText:t,searchString:e}),n.lastSearch&&n.lastSearch.match!==e&&(n.searchCancel(),n.lastSearch=null),null===e&&n.listRef.current&&n.listRef.current.ensureCursorInView(!1)},n.searchPrompt=function(){n.updateSearchString(n.state.searchString||(n.lastSearch?n.lastSearch.match:"")),n.searchRef.current.focus()},n.searchNext=function(){n.searchDisasm(!0)},n.searchCancel=function(){n.lastSearch&&n.lastSearch.cancelState&&(n.lastSearch.cancelState.cancel=!0,n.setState({searchInProgress:!1}),n.lastSearch.cancelState=null)},n.onDoubleClick=function(e,t){n.toggleBreakpoint(t.line)},n.applyScroll=function(e){n.ref.current.scrollTop+=e*n.state.lineHeight},n.ref=r.a.createRef(),n.listRef=r.a.createRef(),n.searchRef=r.a.createRef(),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t={onScroll:function(t){return e.onScroll(t)},onDragStart:function(e){return e.preventDefault()}};return this.props.started?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",Object.assign({ref:this.ref,className:"Disasm"},t),r.a.createElement(X,Object.assign({ref:this.listRef},this.state,{onDoubleClick:this.onDoubleClick,updateSelection:this.props.updateSelection,promptGoto:this.props.promptGoto,updateCursor:this.updateCursor,updateDisplaySymbols:this.updateDisplaySymbols,selectionTop:this.props.selectionTop,selectionBottom:this.props.selectionBottom,getSelectedDisasm:this.getSelectedDisasm,followBranch:this.followBranch,assembleInstruction:this.assembleInstruction,toggleBreakpoint:this.toggleBreakpoint,editBreakpoint:this.editBreakpoint,applyScroll:this.applyScroll,searchPrompt:this.searchPrompt,searchNext:this.searchNext}))),r.a.createElement($,{line:this.state.lines.find((function(t){return t.address===e.state.cursor}))}),this.renderContextMenu(),r.a.createElement(Y,{ref:this.searchRef,searchString:this.state.searchString,searchNext:this.searchNext,updateSearchString:this.updateSearchString,inProgress:this.state.searchInProgress}),r.a.createElement(N,{ppsspp:this.props.ppsspp,currentThread:this.props.currentThread,isOpen:null!==this.state.editingBreakpoint,onClose:this.closeEditBreakpoint,breakpoint:this.state.editingBreakpoint})):this.renderNotStarted()}},{key:"renderNotStarted",value:function(){return r.a.createElement("div",{className:"Disasm--not-started"},"Waiting for a game to start...")}},{key:"renderContextMenu",value:function(){return r.a.createElement(U,{ppsspp:this.props.ppsspp,log:this.props.log,stepping:this.props.stepping,currentThread:this.props.currentThread,getSelectedLines:this.getSelectedLines,getSelectedDisasm:this.getSelectedDisasm,followBranch:this.followBranch,assembleInstruction:this.assembleInstruction,toggleBreakpoint:this.toggleBreakpoint})}},{key:"getSnapshotBeforeUpdate",value:function(e,t){if(this.needsOffsetFix&&this.listRef.current&&0!==this.state.lines.length){var n=this.state.lines,a=n[Math.floor(n.length/2)].address,r=this.listRef.current.addressBoundingTop(a);if(r)return{top:r,centerAddress:a}}return null}},{key:"componentDidMount",value:function(){var e=this;this.listeners_=Q.listen({connection:function(){e.props.started&&e.updateDisasm("center")},"cpu.stepping":function(){var t=0!==e.state.range.start||0!==e.state.range.end;e.updateDisasm(t?"nearest":"center")},"cpu.setReg":function(t){0===t.category&&32===t.register&&e.updateDisasm("center")},"cpu.breakpoint.add":function(){e.updateDisasm()},"cpu.breakpoint.update":function(){e.updateDisasm()},"cpu.breakpoint.remove":function(){e.updateDisasm()}}),this.updatesCancel=!1}},{key:"componentWillUnmount",value:function(){this.searchCancel(),this.updatesCancel=!0,Q.forget(this.listeners_)}},{key:"componentDidUpdate",value:function(e,t,n){var a=this,r=this.props,s=r.selectionTop,i=r.selectionBottom,o=this.state,l=o.range,c=o.lineHeight,u=null,p=null;if(this.state.wantDisplaySymbols!==t.wantDisplaySymbols&&(u=!1),this.props.currentThread!==e.currentThread&&(u=!1),s===e.selectionTop&&i===e.selectionBottom||(s<l.start||i>=l.end)&&(u="center",p=!0),u||e.setInitialPC||!this.props.setInitialPC||(u="center",p=!0),null!==u&&this.props.setInitialPC&&this.updateDisasm(u,p),0===c){var d=document.querySelector(".DisasmLine");d&&setTimeout((function(){return a.setState({lineHeight:d.getBoundingClientRect().height})}),0)}else if(this.ref.current){var h=Math.floor(this.ref.current.clientHeight/c);h!==this.state.visibleLines&&this.setState({visibleLines:h})}if(this.props.jumpMarker!==e.jumpMarker&&(this.needsScroll="center"),this.needsScroll&&this.listRef.current){var f=this.listRef.current;setTimeout((function(){f.ensureCursorInView(a.needsScroll),a.needsScroll=!1}),0)}if(n&&this.listRef.current){var m=this.listRef.current.addressBoundingTop(n.centerAddress);this.ref.current.scrollTop-=n.top-m,this.needsOffsetFix=!1}}},{key:"updateDisasm",value:function(e,t){var n=this;this.updatesSequence=this.updatesSequence.then((function(){return n.updatesCancel?null:n.updateDisasmNow(e,t)}))}},{key:"updateDisasmNow",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this.props.setInitialPC)return Promise.resolve(null);var a=this.state,r=a.range,s=a.visibleLines,i=a.wantDisplaySymbols,o=n;if(!0===n||null===n&&0===r.start&&0===r.end){var l=Math.max(100,s),u=Math.floor(1.5*l);o={address:this.props.selectionTop-4*u,count:2*u}}else null===n&&(o={address:r.start,end:r.end});return Promise.resolve(null).then((function(){return t.props.ppsspp.send(Object(c.a)({event:"memory.disasm",thread:t.props.currentThread},o,{displaySymbols:i})).then((function(n){if(!t.updatesCancel){var a=n.range,r=n.branchGuides,s=n.lines;e?t.needsScroll=e:t.needsOffsetFix=!0,t.setState({range:a,branchGuides:t.cleanupBranchGuides(r),lines:s,displaySymbols:i})}}),(function(e){t.updatesCancel||t.setState({range:{start:0,end:0},branchGuides:[],lines:[]})}))}))}},{key:"cleanupBranchGuides",value:function(e){var t=new Map;return e.forEach((function(e){var n=String(e.top)+String(e.bottom)+e.direction;t.set(n,e)})),Object(v.a)(t.values())}},{key:"onScroll",value:function(e){var t=this;this.updatesSequence=this.updatesSequence.then((function(){if(t.updatesCancel)return null;var e=t.bufferRange(),n=e.bufferTop,a=e.bufferBottom,r=Math.max(100,t.state.visibleLines),s=Math.max(500,5*t.state.visibleLines),i=t.state.range,o=i.start,l=i.end;return n<r?o-=4*r:n>s&&(o+=4*Math.max(r,n-s)),a<r?l+=4*r:a>s&&(l-=4*Math.max(r,a-s)),o!==t.state.range.start||l!==t.state.range.end?t.updateDisasmNow(!1,{address:o,end:l}):null}))}},{key:"bufferRange",value:function(){var e=this.ref.current,t=e.scrollHeight,n=e.scrollTop,a=e.clientHeight,r=n/this.state.lineHeight,s=(t-n-a)/this.state.lineHeight,i=Math.floor((this.state.visibleLines-1)/2);return{bufferTop:r+i,bufferBottom:s+i}}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.selectionTop,a=e.selectionBottom;if(t.cursor<n||t.cursor>a){var r=n;if(t.lines.length){var s=t.lines.find((function(e){return e.address<=n&&e.address+e.addressSize>n}));r=s?s.address:r}return{cursor:r}}return null}}]),t}(a.PureComponent)),ee=(n(491),function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={breakpointModalOpen:!1,connected:!1,lastThread:"",threads:[]},n.handleGoBreak=function(){n.props.stepping&&n.props.updateCurrentThread(void 0),n.props.ppsspp.send({event:n.props.stepping?"cpu.resume":"cpu.stepping"}).catch((function(){}))},n.handleStepInto=function(){n.props.updateCurrentThread(void 0),n.props.ppsspp.send({event:"cpu.stepInto",thread:n.props.currentThread}).catch((function(){}))},n.handleStepOver=function(){n.props.updateCurrentThread(void 0),n.props.ppsspp.send({event:"cpu.stepOver",thread:n.props.currentThread}).catch((function(){}))},n.handleStepOut=function(){var e=n.props.currentThread;n.props.updateCurrentThread(void 0),n.props.ppsspp.send({event:"cpu.stepOut",thread:n.props.currentThread}).catch((function(){n.props.updateCurrentThread(e)}))},n.handleNextHLE=function(){n.props.updateCurrentThread(void 0),n.props.ppsspp.send({event:"cpu.nextHLE"}).catch((function(){}))},n.handleThreadSelect=function(e){var t=n.state.threads.find((function(t){return t.id===Number(e.target.value)}));t&&n.props.updateCurrentThread(t.id,t.pc)},n.handleBreakpointOpen=function(){n.setState({breakpointModalOpen:!0})},n.handleBreakpointClose=function(){n.setState({breakpointModalOpen:!1})},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=!this.props.started||!this.props.stepping;return r.a.createElement("div",{className:"DisasmButtons"},r.a.createElement("button",{type:"button",disabled:!this.props.started||this.props.paused,onClick:this.handleGoBreak},this.props.stepping||!this.props.started?"Go":"Break"),r.a.createElement("span",{className:"DisasmButtons__spacer"}),r.a.createElement("button",{type:"button",disabled:e,onClick:this.handleStepInto},"Step Into"),r.a.createElement("button",{type:"button",disabled:e,onClick:this.handleStepOver},"Step Over"),r.a.createElement("button",{type:"button",disabled:e,onClick:this.handleStepOut},"Step Out"),r.a.createElement("span",{className:"DisasmButtons__spacer"}),r.a.createElement("button",{type:"button",disabled:e,onClick:this.handleNextHLE},"Next HLE"),r.a.createElement("span",{className:"DisasmButtons__spacer"}),r.a.createElement("button",{type:"button",onClick:this.handleBreakpointOpen,disabled:!this.props.started},"Breakpoint"),r.a.createElement("span",{className:"DisasmButtons__spacer"}),r.a.createElement("span",{className:"DisasmButtons__thread-list"},"Thread: ",this.renderThreadList()),r.a.createElement(N,{ppsspp:this.props.ppsspp,currentThread:this.props.currentThread,isOpen:this.state.breakpointModalOpen,onClose:this.handleBreakpointClose}))}},{key:"renderThreadList",value:function(){var e=this;return 0===this.state.threads.length?"(none)":r.a.createElement("select",{onChange:this.handleThreadSelect,value:this.props.currentThread||this.state.lastThread},this.state.threads.map((function(t){return e.renderThread(t)})))}},{key:"renderThread",value:function(e){var t="DisasmButtons__thread"+(e.isCurrent?" DisasmButtons__thread--current":"");return r.a.createElement("option",{key:e.id,value:e.id,className:t},e.name,e.isCurrent?" (current)":"")}},{key:"componentDidMount",value:function(){var e=this;this.listeners_=Q.listen({"connection.change":function(t){return e.setState({connected:t})},"cpu.stepping":function(){return e.updateThreadList(!0)}})}},{key:"componentWillUnmount",value:function(){Q.forget(this.listeners_)}},{key:"componentDidUpdate",value:function(e,t){!t.connected&&this.state.connected&&this.updateThreadList(void 0===this.props.currentThread)}},{key:"updateThreadList",value:function(e){var t=this;this.state.connected&&this.props.ppsspp.send({event:"hle.thread.list"}).then((function(n){var a=n.threads;if(t.setState({threads:a}),e){var r=a.find((function(e){return e.isCurrent}));r&&r.id!==t.props.currentThread&&t.props.updateCurrentThread(r.id)}}),(function(){t.setState({threads:[]})}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=null;return e.currentThread&&e.currentThread!==t.lastThread&&(n=Object(c.a)({},n,{lastThread:e.currentThread||""})),(e.stepping||e.started)&&(n=Object(c.a)({},n,{connected:!0})),!e.started&&t.threads.length&&(n=Object(c.a)({},n,{threads:[]})),n}}]),t}(a.PureComponent)),te=(n(492),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={address:""},n.handleChange=function(e){n.setState({address:e.target.value})},n.handleSubmit=function(e){n.props.started&&n.props.ppsspp.send({event:"cpu.evaluate",thread:n.props.currentThread,expression:n.state.address}).then((function(e){var t=e.uintValue;n.props.started&&n.props.gotoDisasm(t)})),e.preventDefault()},n.handlePC=function(e){n.jumpToReg("pc")},n.handleRA=function(e){n.jumpToReg("ra")},n.ref=r.a.createRef(),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=!this.props.started;return r.a.createElement("form",{action:"#",className:"GotoBox",onSubmit:this.handleSubmit},r.a.createElement("label",{className:"GotoBox__label",htmlFor:"GotoBox__address"},"Go to:"),r.a.createElement("input",{ref:this.ref,type:"text",id:"GotoBox__address",value:this.state.address,onChange:this.handleChange,title:"Hexadecimal address or expression, enter to submit",autoComplete:"off"}),r.a.createElement("button",{type:"button",className:"GotoBox__button",onClick:this.handlePC,disabled:e},"PC"),r.a.createElement("button",{type:"button",className:"GotoBox__button",onClick:this.handleRA,disabled:e},"RA"))}},{key:"componentDidUpdate",value:function(e,t){this.props.promptGotoMarker!==e.promptGotoMarker&&(this.ref.current.focus(),this.ref.current.select())}},{key:"jumpToReg",value:function(e){var t=this;this.props.ppsspp.send({event:"cpu.getReg",name:e}).then((function(e){t.props.started&&t.props.gotoDisasm(e.uintValue)}))}}]),t}(a.PureComponent)),ne=n(40),ae=n(208),re=(n(551),n(552),function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return(n=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(s)))).state={connected:!1,loading:!0,rowHeight:null,functions:[],filter:"",filteredFunctions:[]},n.renderSizedList=function(e){var t=e.height,a=e.width,s=n.state,i=s.filter,o=s.filteredFunctions,l=s.rowHeight;return r.a.createElement(ae.b,{height:t,rowHeight:l,rowRenderer:n.renderFunc,width:a,rowCount:o.length,filter:i})},n.renderFunc=function(e){var t=e.index,a=e.key,s=e.style,i=n.state.filteredFunctions[t];return r.a.createElement("div",{key:a+"-"+i.address,style:s},r.a.createElement("button",{type:"button","data-address":i.address},i.name))},n.handleFilter=function(e){var t=e.target.value,a=n.applyFilter(n.state.functions,t);n.setState({filter:t,filteredFunctions:a})},n.handleClick=function(e){var t=e.target.dataset.address;n.props.gotoDisasm(Number(t)),e.preventDefault()},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.state.filter;return r.a.createElement("div",{className:"FuncList"},r.a.createElement("input",{type:"search",className:"FuncList__search",value:e,onChange:this.handleFilter}),this.renderList())}},{key:"renderList",value:function(){var e=this.state,t=e.filter,n=e.loading,a=e.rowHeight;return n||!a?r.a.createElement("div",{className:"FuncList__loading"},"Loading..."):r.a.createElement("div",{className:"FuncList__listing",onClick:this.handleClick},r.a.createElement(ae.a,{filter:t},this.renderSizedList))}},{key:"componentDidMount",value:function(){var e=this;this.listeners_=Q.listen({"connection.change":function(t){return e.setState({connected:t})},"game.start":function(){return e.updateList()}}),this.state.connected&&this.updateList(),this.state.rowHeight||setTimeout((function(){return e.measureHeight()}),0)}},{key:"componentWillUnmount",value:function(){Q.forget(this.listeners_)}},{key:"componentDidUpdate",value:function(e,t){var n=this;!t.connected&&this.state.connected&&this.updateList(),this.state.rowHeight||setTimeout((function(){return n.measureHeight()}),0)}},{key:"measureHeight",value:function(){var e=document.querySelector(".FuncList__loading");if(e){var t=e.getBoundingClientRect().height;this.setState({rowHeight:t})}}},{key:"updateList",value:function(){var e=this;this.state.connected&&(this.state.loading||0!==this.state.functions.length||this.setState({loading:!0}),this.props.ppsspp.send({event:"hle.func.list"}).then((function(t){var n=t.functions;n.sort((function(e,t){return e.name.localeCompare(t.name)}));var a=e.applyFilter(n,e.state.filter);e.setState({functions:n,filteredFunctions:a,loading:!1})}),(function(){e.setState({functions:[],filteredFunctions:[],loading:!1})})))}},{key:"applyFilter",value:function(e,t){if(""===t)return e;var n=t.toLowerCase();return e.filter((function(e){return-1!==e.name.toLowerCase().indexOf(n)}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=null;return e.started&&(n=Object(c.a)({},n,{connected:!0})),!e.started&&t.functions.length&&(n=Object(c.a)({},n,{functions:[],filteredFunctions:[]})),n}}]),t}(a.PureComponent)),se=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={cursor:0},n.needsScroll=!1,n.onDoubleClick=function(e,t){0===e.button&&n.props.onDoubleClick(e,t)},n.cursorRef=r.a.createRef(),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("dl",null,this.props.registerNames.map((function(t,n){return e.renderReg(t,n)})))}},{key:"renderReg",value:function(e,t){var n=this,a=function(e){return{cat:n.props.id,reg:t,value:n.format(t)}},s={onDoubleClick:function(e){return n.onDoubleClick(e,a())},onMouseDown:function(e){return n.setState({cursor:t})},onKeyDown:function(e){return n.onKeyDown(e)},tabIndex:0},i={"RegPanel__item--changed":this.changed(t),"RegPanel__item--selected":this.state.cursor===t},o=this.state.cursor===t?this.cursorRef:void 0;return r.a.createElement(B.b,{id:this.props.contextmenu,renderTag:"a",attributes:s,collect:a,key:t},r.a.createElement("dt",null,e),r.a.createElement("dd",{className:w()(i),ref:o},this.format(t)))}},{key:"format",value:function(e){return 0===this.props.id?j(this.props.uintValues[e]):this.props.floatValues[e]}},{key:"changed",value:function(e){return this.props.uintValues[e]!==this.props.uintValuesLast[e]}},{key:"componentDidUpdate",value:function(e,t){if(this.needsScroll&&this.cursorRef.current){var n=this.cursorRef.current.parentNode;q(n,{block:"nearest"}),n.focus(),this.needsScroll=!1}}},{key:"onKeyDown",value:function(e){W()||("ArrowUp"===e.key&&this.state.cursor>0&&(this.needsScroll=!0,this.setState({cursor:this.state.cursor-1}),e.preventDefault()),"ArrowDown"===e.key&&this.state.cursor<this.props.registerNames.length-1&&(this.needsScroll=!0,this.setState({cursor:this.state.cursor+1}),e.preventDefault()))}}]),t}(a.PureComponent),ie=(n(553),n(554),n(445),function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={categories:[]},n.handleViewMemory=function(e,t){console.log(t)},n.handleViewDisassembly=function(e,t){var a=n.state.categories[t.cat].uintValues[t.reg];n.props.gotoDisasm(a)},n.handleCopyReg=function(e,t,n){A(t.value)},n.handleChangeReg=function(e,t,a){var r=(0===t.cat?"0x":"")+t.value,s=n.state.categories[t.cat].registerNames[t.reg],i=window.prompt("New value for "+s,r);if(null!==i){var o={event:"cpu.setReg",thread:n.props.currentThread,category:t.cat,register:t.reg,value:i};n.props.ppsspp.send(o).catch((function(e){window.alert(e)}))}},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{id:"RegPanel"},this.renderTabs(),this.renderContextMenu())}},{key:"renderTabs",value:function(){var e=this,t=this.state.categories;return 0===t.length?"":r.a.createElement(ne.d,null,r.a.createElement(ne.b,null,t.map((function(e){return r.a.createElement(ne.a,{key:e.id},e.name)}))),t.map((function(t){return r.a.createElement(ne.c,{key:t.id},r.a.createElement(se,Object.assign({contextmenu:"reglist",onDoubleClick:e.handleChangeReg},t)))})))}},{key:"renderContextMenu",value:function(){var e=!this.props.stepping;return r.a.createElement(B.a,{id:"reglist"},r.a.createElement(B.c,{onClick:this.handleViewMemory},"Go to in Memory View"),r.a.createElement(B.c,{onClick:this.handleViewDisassembly},"Go to in Disassembly"),r.a.createElement(B.c,{divider:!0}),r.a.createElement(B.c,{onClick:this.handleCopyReg},"Copy Value"),r.a.createElement(B.c,{disabled:e,onClick:this.handleChangeReg},"Change..."))}},{key:"componentDidMount",value:function(){var e=this;this.listeners_=Q.listen({"connection.change":function(t){return t&&e.updateRegs(!1)},"cpu.stepping":function(){return e.updateRegs(!1)},"cpu.setReg":function(t){return e.updateReg(t)}})}},{key:"componentWillUnmount",value:function(){Q.forget(this.listeners_)}},{key:"componentDidUpdate",value:function(e,t){this.props.currentThread&&this.props.currentThread!==e.currentThread&&this.updateRegs(!0)}},{key:"updateRegs",value:function(e){var t=this;this.props.ppsspp.send({event:"cpu.getAllRegs",thread:this.props.currentThread}).then((function(n){var a=n.categories,r=0!==t.state.categories.length,s=!0,i=!1,o=void 0;try{for(var l,c=a[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var u=l.value,p=r?t.state.categories[u.id]:null;u.uintValuesLast=r?e?p.uintValuesLast:p.uintValues:u.uintValues,u.floatValuesLast=r?e?p.floatValuesLast:p.floatValues:u.floatValues}}catch(d){i=!0,o=d}finally{try{s||null==c.return||c.return()}finally{if(i)throw o}}t.setState({categories:a})}),(function(e){console.error(e)}))}},{key:"updateReg",value:function(e){var t=function(e,t,n){return e.slice(0,t).concat([n]).concat(e.slice(t+1))},n=this.state.categories.map((function(n){return n.id===e.category?Object(c.a)({},n,{uintValuesLast:n.uintValuesLast,floatValuesLast:n.floatValuesLast,uintValues:t(n.uintValues,e.register,e.uintValue),floatValues:t(n.floatValues,e.register,e.floatValue)}):n}));this.setState({categories:n})}}]),t}(a.PureComponent)),oe=(n(555),function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={categories:[],format:"float"},n.handleFormat=function(e){var t=e.target.value;n.setState({format:t})},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.state,t=e.categories,n=e.format;if(t.length<3)return null;for(var a=[],s=0;s<t[2].uintValues.length/16;++s)a.push(this.renderMatrix(s));return r.a.createElement(b,{contentLabel:"VFPU",isOpen:this.props.isOpen,onClose:this.props.onClose},r.a.createElement("h2",null,"VFPU Registers"),r.a.createElement("div",{className:"VisualizeVFPU__list"},a),r.a.createElement("div",{className:"VisualizeVFPU__format"},"Display as:",r.a.createElement("label",null,r.a.createElement("input",{type:"radio",checked:"float"===n,value:"float",onChange:this.handleFormat})," Float"),r.a.createElement("label",null,r.a.createElement("input",{type:"radio",checked:"uint"===n,value:"uint",onChange:this.handleFormat})," Hex")))}},{key:"renderMatrix",value:function(e){return r.a.createElement("table",{className:"VisualizeVFPU__matrix",key:e},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:"VisualizeVFPU__name"},"M",e,"00"),r.a.createElement("th",{className:"VisualizeVFPU__row-header"},"R",e,"00"),r.a.createElement("th",{className:"VisualizeVFPU__row-header"},"R",e,"01"),r.a.createElement("th",{className:"VisualizeVFPU__row-header"},"R",e,"02"),r.a.createElement("th",{className:"VisualizeVFPU__row-header"},"R",e,"03"))),r.a.createElement("tbody",null,this.renderColumn(e,0),this.renderColumn(e,1),this.renderColumn(e,2),this.renderColumn(e,3)))}},{key:"renderColumn",value:function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("th",{className:"VisualizeVFPU__col-header"},"C",e,t,"0"),r.a.createElement("td",null,this.renderValue(e,t,0)),r.a.createElement("td",null,this.renderValue(e,t,1)),r.a.createElement("td",null,this.renderValue(e,t,2)),r.a.createElement("td",null,this.renderValue(e,t,3)))}},{key:"renderValue",value:function(e,t,n){var a=4*e+32*t+n,r=this.state.categories[2];return"uint"===this.state.format?j(r.uintValues[a]):r.floatValues[a]}},{key:"componentDidMount",value:function(){var e=this;this.listeners_=Q.listen({"cpu.getAllRegs":function(t){var n=t.categories;return e.setState({categories:n})}})}},{key:"componentWillUnmount",value:function(){Q.forget(this.listeners_)}}]),t}(a.PureComponent)),le=(n(556),function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={vfpuModalOpen:!1,everShownFuncs:!1},n.handleSelect=function(e){1!==e||n.state.everShownFuncs||n.setState({everShownFuncs:!0})},n.handleVFPUOpen=function(){n.setState({vfpuModalOpen:!0})},n.handleVFPUClose=function(){n.setState({vfpuModalOpen:!1})},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"LeftPanel"},r.a.createElement(ne.d,{onSelect:this.handleSelect},r.a.createElement(ne.b,null,r.a.createElement(ne.a,null,"Regs"),r.a.createElement(ne.a,null,"Funcs"),r.a.createElement(ne.a,null,"Tools")),r.a.createElement(ne.c,{forceRender:!0},r.a.createElement(ie,this.props)),r.a.createElement(ne.c,{forceRender:this.state.everShownFuncs},r.a.createElement(re,this.props)),r.a.createElement(ne.c,{className:"react-tabs__tab-panel LeftPanel__tools"},r.a.createElement("button",{type:"button",onClick:this.handleVFPUOpen},"Visualize VFPU"))),r.a.createElement(oe,Object.assign({},this.props,{isOpen:this.state.vfpuModalOpen,onClose:this.handleVFPUClose})))}}]),t}(a.PureComponent)),ce=(n(557),function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={stepping:!1,paused:!0,started:!1,pc:0,setInitialPC:!1,selectionTop:null,selectionBottom:null,jumpMarker:null,promptGotoMarker:null,lastTicks:0,ticks:0,currentThread:void 0},n.updateSelection=function(e){n.setState(e)},n.gotoDisasm=function(e){n.setState({selectionTop:e,selectionBottom:e,jumpMarker:{}})},n.promptGoto=function(){n.setState({promptGotoMarker:{}})},n.updateCurrentThread=function(e,t){n.setState({currentThread:e,pc:t,setInitialPC:0!==t}),t&&n.gotoDisasm(t)},n.updateInitialPC=function(){n.props.ppsspp.send({event:"cpu.getReg",name:"pc"}).then((function(e){var t=e.uintValue;n.state.setInitialPC||n.gotoDisasm(t),n.setState({pc:t,setInitialPC:0!==t})}))},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.state,t=e.paused,n={stepping:e.stepping&&!t,paused:t,started:e.started,currentThread:e.currentThread},a=this.state,s=a.selectionTop,i=a.selectionBottom,o=a.jumpMarker,l=a.pc,u=a.setInitialPC,p=Object(c.a)({},n,{selectionTop:s,selectionBottom:i,jumpMarker:o,pc:l,setInitialPC:u});return r.a.createElement("div",{id:"CPU"},r.a.createElement("div",{className:"CPU__pane"},r.a.createElement(te,Object.assign({ppsspp:this.props.ppsspp},n,{gotoDisasm:this.gotoDisasm,promptGotoMarker:this.state.promptGotoMarker})),r.a.createElement(le,Object.assign({},this.props,n,{gotoDisasm:this.gotoDisasm}))),r.a.createElement("div",{className:"Disasm__container"},r.a.createElement(ee,Object.assign({},this.props,n,{updateCurrentThread:this.updateCurrentThread})),r.a.createElement(Z,Object.assign({},this.props,p,{updateSelection:this.updateSelection,promptGoto:this.promptGoto}))))}},{key:"componentDidMount",value:function(){var e=this;this.listeners_=Q.listen({connection:function(){return e.onConnection()},"connection.change":function(t){return e.onConnectionChange(t)},"cpu.stepping":function(t){return e.onStepping(t)},"cpu.resume":function(){return e.setState({stepping:!1})},"game.start":function(){e.state.setInitialPC||e.updateInitialPC(),e.setState({started:!0,paused:!1})},"game.quit":function(){e.setState({started:!1,stepping:!1,paused:!0,pc:0,setInitialPC:!1,currentThread:void 0})},"game.pause":function(){return e.setState({paused:!0})},"game.resume":function(){return e.setState({paused:!1})},"cpu.setReg":function(t){if(0===t.category&&32===t.register){var n=t.uintValue;e.state.setInitialPC||e.gotoDisasm(n),e.setState({pc:n,setInitialPC:0!==n})}},"cpu.getAllRegs":function(t){var n=t.categories[0].uintValues[32];e.state.setInitialPC||e.gotoDisasm(n),e.setState({pc:n,setInitialPC:0!==n})}})}},{key:"componentWillUnmount",value:function(){Q.forget(this.listeners_)}},{key:"onConnectionChange",value:function(e){this.setState({connected:e,started:!1,stepping:!1,paused:!0}),e||this.setState({currentThread:void 0})}},{key:"onConnection",value:function(){var e=this;this.props.ppsspp.send({event:"cpu.status"}).then((function(t){var n=t.stepping,a=t.paused,r=t.pc,s=t.ticks,i=0!==r||n;e.state.setInitialPC||e.gotoDisasm(r),e.setState({connected:!0,started:i,stepping:n,paused:a,pc:r,setInitialPC:0!==r,ticks:s,lastTicks:s})}),(function(t){e.setState({stepping:!1,paused:!0})}))}},{key:"onStepping",value:function(e){this.setState({stepping:!0,pc:e.pc,selectionTop:e.pc,selectionBottom:e.pc,lastTicks:this.state.ticks,ticks:e.ticks})}}]),t}(a.PureComponent)),ue=(n(558),function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={connected:!1,started:!1,paused:!0,recording:!1},n.beginRecord=function(e){n.setState({recording:!0}),n.props.ppsspp.send({event:"gpu.record.dump"}).then((function(e){var t=document.createElement("a");t.setAttribute("download","recording.ppdmp"),t.href=e.uri,t.hidden=!0,document.body.appendChild(t),t.click(),document.body.removeChild(t),n.setState({recording:!1})})),e.preventDefault()},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{id:"GPU"},r.a.createElement("div",{className:"GPU__info"},this.state.started&&!this.state.paused?"Click below to generate a GE dump.  It will download as a file.":"Waiting for a game to start..."),this.state.started&&!this.state.paused?r.a.createElement("form",{className:"GPU__form",onSubmit:this.beginRecord},r.a.createElement("button",{disabled:this.state.recording},this.state.recording?"Recording...":"Record")):null)}},{key:"componentDidMount",value:function(){var e=this;this.listeners_=Q.listen({connection:function(){return e.onConnection()},"connection.change":function(t){return e.onConnectionChange(t)},"game.start":function(){return e.setState({started:!0,paused:!1})},"game.quit":function(){return e.setState({started:!1,paused:!0})},"game.pause":function(){return e.setState({paused:!0})},"game.resume":function(){return e.setState({paused:!1})}})}},{key:"componentWillUnmount",value:function(){Q.forget(this.listeners_)}},{key:"onConnectionChange",value:function(e){this.setState({connected:e,started:!1,paused:!0})}},{key:"onConnection",value:function(){var e=this;this.props.ppsspp.send({event:"cpu.status"}).then((function(t){var n=t.stepping,a=t.paused,r=0!==t.pc||n;e.setState({connected:!0,started:r,paused:a})}),(function(t){e.setState({paused:!0})}))}}]),t}(a.PureComponent)),pe=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return"log"===this.props.item.event?this.formatLogEvent():this.renderInternal()}},{key:"renderInternal",value:function(){return r.a.createElement("span",{className:this.makeClassName()},this.props.item.message)}},{key:"formatLogEvent",value:function(){var e=this.props.item;return r.a.createElement("span",{className:this.makeClassName()},r.a.createElement("span",{className:"Log__message__header"},r.a.createElement("span",{className:"Log__message__timestamp"},e.timestamp)," "+e.header+" "),e.message)}},{key:"makeClassName",value:function(){var e,t=this.props.item;return w()("Log__message",(e={"Log__message--internal":"log"!==t.event},Object(k.a)(e,"Log__message--channel-"+t.channel,"log"===t.event),Object(k.a)(e,"Log__message--level-"+t.level,!0),e))}}]),t}(a.PureComponent),de=(n(559),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={id:0,items:[]},n.divRef=r.a.createRef(),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{id:"Log",ref:this.divRef},this.state.items.map(this.renderItem.bind(this)))}},{key:"renderItem",value:function(e){return r.a.createElement(pe,{key:e.id,item:e})}},{key:"addLogItem",value:function(e){var t=this.state.id+1,n=Object(c.a)({id:t},e),a=this.state.items.concat([n]).slice(-5e3);this.setState({id:t,items:a})}},{key:"componentDidMount",value:function(){var e=this;this.props.ppsspp.onError=function(t,n){var a={message:t+"\n",level:n};e.addLogItem(a)},this.listeners_=Q.listen({log:this.onLogEvent.bind(this)})}},{key:"componentDidUpdate",value:function(e,t){if(t.id!==this.state.id){var n=this.divRef.current;n.scrollTop=n.scrollHeight-n.clientHeight}}},{key:"componentWillUnmount",value:function(){Q.forget(this.listeners_)}},{key:"onLogEvent",value:function(e){var t=Object(c.a)({},e);this.addLogItem(t)}}]),t}(a.PureComponent));n(560);function he(e){return r.a.createElement("div",{id:"NotConnected"},e.connecting?"Connecting to PPSSPP...":"Not connected to PPSSPP",r.a.createElement("div",{className:"NotConnected__info"},'Make sure "Allow remote debugger" is enabled in Developer tools.'),r.a.createElement("form",{className:"NotConnected__form",onSubmit:function(t){var n=t.target.elements["debugger-uri"].value;e.connect(n),t.preventDefault()}},r.a.createElement("input",{type:"text",name:"debugger-uri",placeholder:"ws://ip:port/debugger",className:"NotConnected__uri"}),r.a.createElement("button",{disabled:e.connecting},"Connect Manually")),r.a.createElement("form",{className:"NotConnected__form",onSubmit:function(t){e.connect(null),t.preventDefault()}},r.a.createElement("button",{disabled:e.connecting},"Connect Automatically")))}var fe=["cpu.stepping","cpu.resume"],me=2,ge=function(){function e(){Object(u.a)(this,e),this.onError=null,this.onClose=null,this.socket_=null,this.pendingTickets_={},this.listeners_={}}return Object(p.a)(e,[{key:"autoConnect",value:function(){var e=this;if(null!==this.socket_)return Promise.reject(new Error("Already connected, disconnect first"));var t=new Error("Couldn't connect");return fetch("//report.ppsspp.org/match/list").then((function(e){return e.json()})).then((function(t){return e.tryNextEndpoint_(t)})).then(this.setupSocket_.bind(this),(function(e){throw t.message=e.message,t.originalError=e,t}))}},{key:"connect",value:function(e){var t=this;if(null!==this.socket_)return Promise.reject(new Error("Already connected, disconnect first"));var n=new Error("Couldn't connect to "+e);return new Promise((function(a,r){var s=new WebSocket(e,"debugger.ppsspp.org");s.onopen=function(){t.socket_=s,a()},s.onclose=function(){r(n)}})).then(this.setupSocket_.bind(this))}},{key:"disconnect",value:function(){if(null===this.socket_)throw new Error("Not connected");this.failAllPending_("Disconnected from PPSSPP"),this.socket_.close(1e3),this.socket_=null}},{key:"listen",value:function(e,t){var n=this;return e in this.listeners_||(this.listeners_[e]=[]),this.listeners_[e].push(t),{remove:function(){var a=n.listeners_[e],r=a.indexOf(t);-1!==r&&a.splice(r,1)}}}},{key:"send",value:function(e){var t=this;if(null===this.socket_)return Promise.reject(new Error("Not connected"));var n=new Error("PPSSPP returned an error");return fe.includes(e.event)?(this.socket_.send(JSON.stringify(e)),Promise.resolve(null)):new Promise((function(a,r){var s=t.makeTicket_();t.pendingTickets_[s]=function(e){"error"===e.event?(n.name="DebuggerError",n.message=e.message,n.originalMessage=e,r(n)):a(e)},t.socket_.send(JSON.stringify(Object(c.a)({},e,{ticket:s})))}))}},{key:"setupSocket_",value:function(){var e=this;this.socket_.onclose=function(){e.onClose&&e.onClose(),e.failAllPending_("PPSSPP disconnected"),e.socket_=null},this.socket_.onmessage=function(t){try{var n=JSON.parse(t.data);"error"===n.event&&e.handleError_(n.message,n.level);var a=!1;"ticket"in n&&(a=e.handleTicket_(n.ticket,n)),e.handleMessage_(n,a)}catch(r){e.handleError_("Failed to parse message from PPSSPP: "+r.message,me)}}}},{key:"tryNextEndpoint_",value:function(e){var t=this;return new Promise((function(n,a){if(!e||0===e.length)return a(new Error("Couldn't connect automatically.  Is PPSSPP connected to the same network?"));var r="ws://"+e[0].ip+":"+e[0].p+"/debugger";return t.connect(r).then(n,(function(r){e.length>1?n(t.tryNextEndpoint_(e.slice(1))):a(r)}))}))}},{key:"handleTicket_",value:function(e,t){if(e in this.pendingTickets_){var n=this.pendingTickets_[t.ticket];return delete this.pendingTickets_[t.ticket],n(t),!0}return this.handleError_("Received mismatched ticket: "+JSON.stringify(t),me),!1}},{key:"handleMessage_",value:function(e,t){t=this.executeHandlers_(e.event,e,t),this.executeHandlers_("*",e,t)}},{key:"executeHandlers_",value:function(e,t,n){if(e in this.listeners_){var a=!0,r=!1,s=void 0;try{for(var i,o=this.listeners_[e][Symbol.iterator]();!(a=(i=o.next()).done);a=!0){(0,i.value)(t,n)&&(n=!0)}}catch(l){r=!0,s=l}finally{try{a||null==o.return||o.return()}finally{if(r)throw s}}}return n}},{key:"handleError_",value:function(e,t){this.onError?this.onError(e,t):void 0===t||Number(t)===me?console.error(e):console.log(e)}},{key:"makeTicket_",value:function(){var e=Math.random().toString(36).substr(2);return e in this.pendingTickets_?this.makeTicket_():e}},{key:"failAllPending_",value:function(e){var t={event:"error",message:e,level:me};for(var n in this.pendingTickets_)this.pendingTickets_.hasOwnProperty(n)&&this.pendingTickets_[n](t);this.pendingTickets_={}}}]),e}(),ve=n(453),be=n.n(ve),ye=(n(561),{name:"ppsspp-debugger",version:"0.1.0"}),ke=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={connected:!1,connecting:!1},n.handleAutoConnect=function(){n.connect(null)},n.connect=function(e){n.setState({connecting:!0}),n.ppsspp.onClose=function(){n.log("Debugger disconnected"),Q.change(!1),n.setState({connected:!1,connecting:!1})},(null===e?n.ppsspp.autoConnect():n.ppsspp.connect(e)).then((function(){n.log("Debugger connected"),Q.change(!0),n.setState({connected:!0,connecting:!1})}),(function(e){n.log("Debugger could not connect"),Q.change(!1),n.setState({connected:!1,connecting:!1})}))},n.handleDisconnect=function(){n.ppsspp.disconnect()},n.log=function(e){n.logRef.current?n.logRef.current.addLogItem({message:e+"\n"}):console.error(e)},n.updateTitle=function(e){document&&(e.game?document.title=n.originalTitle+" - "+e.game.id+": "+e.game.title:document.title=n.originalTitle)},n.onConnectionChange=function(e){e?(n.ppsspp.send(Object(c.a)({event:"version"},ye)).catch((function(e){window.alert("PPSSPP seems to think this debugger is out of date.  Try refreshing?\n\nDetails: "+e)})),n.ppsspp.send({event:"game.status"}).then(n.updateTitle,(function(e){return n.updateTitle({})}))):n.updateTitle({})},n.logRef=r.a.createRef(),n.ppsspp=new ge,n.originalTitle=document.title,Q.init(n.ppsspp),Q.listen({"connection.change":n.onConnectionChange,"game.start":n.updateTitle,"game.quit":n.updateTitle}),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement(m.a,null,r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement("ul",{className:"App-nav"},r.a.createElement(m.b,{to:"/cpu"},"CPU"),r.a.createElement(m.b,{to:"/gpu"},"GPU")),r.a.createElement("img",{src:be.a,className:"App-logo",alt:"PPSSPP"}),r.a.createElement("h1",{className:"App-title"},"Debugger")),this.renderContent(),r.a.createElement(de,{ppsspp:this.ppsspp,ref:this.logRef})))}},{key:"renderContent",value:function(){return this.state.connected?r.a.createElement(g.c,null,r.a.createElement(g.a,{path:"/gpu"},r.a.createElement(ue,{ppsspp:this.ppsspp,log:this.log})),r.a.createElement(g.a,null,r.a.createElement(ce,{ppsspp:this.ppsspp,log:this.log}))):r.a.createElement(he,{connecting:this.state.connecting,connect:this.connect})}},{key:"componentDidMount",value:function(){this.props.testing||this.handleAutoConnect()}}]),t}(a.Component),Ce=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Se(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}n(447),n(564),n(572);i.a.render(r.a.createElement(ke,null),document.getElementById("root")),l.a.setAppElement("#root"),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("","/service-worker.js");Ce?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Se(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):Se(e)}))}}()}},[[458,1,2]]]);
//# sourceMappingURL=main.92d76747.chunk.js.map